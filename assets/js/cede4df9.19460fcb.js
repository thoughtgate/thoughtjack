"use strict";(globalThis.webpackChunkthoughtjack_docs_site=globalThis.webpackChunkthoughtjack_docs_site||[]).push([[2413],{9064(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"how-to/add-scenario","title":"Add a Scenario to the Library","description":"Create and register a new attack scenario in ThoughtJack\'s library","source":"@site/docs/how-to/add-scenario.mdx","sourceDirName":"how-to","slug":"/how-to/add-scenario","permalink":"/docs/how-to/add-scenario","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Add a Scenario to the Library","sidebar_position":2,"description":"Create and register a new attack scenario in ThoughtJack\'s library"},"sidebar":"docs","previous":{"title":"How-To Guides","permalink":"/docs/how-to/"},"next":{"title":"How-To Guides","permalink":"/docs/how-to/"}}');var i=n(4848),a=n(8453);const d={title:"Add a Scenario to the Library",sidebar_position:2,description:"Create and register a new attack scenario in ThoughtJack's library"},s="Add a Scenario to the Library",c={},o=[{value:"1. Create the YAML file",id:"1-create-the-yaml-file",level:2},{value:"2. Add metadata",id:"2-add-metadata",level:2},{value:"3. Add MITRE ATT&amp;CK and OWASP mappings",id:"3-add-mitre-attck-and-owasp-mappings",level:2},{value:"4. Validate",id:"4-validate",level:2},{value:"5. Test the scenario",id:"5-test-the-scenario",level:2},{value:"6. Generate documentation",id:"6-generate-documentation",level:2}];function l(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"add-a-scenario-to-the-library",children:"Add a Scenario to the Library"})}),"\n",(0,i.jsxs)(t.p,{children:["This guide walks you through creating a new attack scenario and adding it to ThoughtJack's library so it appears in ",(0,i.jsx)(t.code,{children:"scenarios list"})," and the generated documentation."]}),"\n",(0,i.jsx)(t.h2,{id:"1-create-the-yaml-file",children:"1. Create the YAML file"}),"\n",(0,i.jsxs)(t.p,{children:["Create a new file in the ",(0,i.jsx)(t.code,{children:"library/servers/"})," directory:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="library/servers/my_attack.yaml"',children:'server:\n  name: "helpful-assistant"\n  version: "1.0.0"\n\nmetadata:\n  id: "my-attack"\n  name: "My Custom Attack"\n  description: "Brief description of the attack pattern"\n  category: "injection"\n  severity: "high"\n  tags:\n    - prompt-injection\n    - tool-manipulation\n\ntools:\n  - tool:\n      name: "assistant"\n      description: "A helpful assistant tool."\n      inputSchema:\n        type: object\n        properties:\n          query:\n            type: string\n        required: ["query"]\n    response:\n      content:\n        - type: text\n          text: "Response to: ${args.query}"\n'})}),"\n",(0,i.jsx)(t.h2,{id:"2-add-metadata",children:"2. Add metadata"}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"metadata"})," block controls how the scenario appears in listings and documentation:"]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Field"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"id"})}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"Unique kebab-case identifier"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"name"})}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"Human-readable display name"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"description"})}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsx)(t.td,{children:"One-line description"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"category"})}),(0,i.jsx)(t.td,{children:"Yes"}),(0,i.jsxs)(t.td,{children:["One of: ",(0,i.jsx)(t.code,{children:"injection"}),", ",(0,i.jsx)(t.code,{children:"dos"}),", ",(0,i.jsx)(t.code,{children:"temporal"}),", ",(0,i.jsx)(t.code,{children:"resource"}),", ",(0,i.jsx)(t.code,{children:"protocol"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"severity"})}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"low"}),", ",(0,i.jsx)(t.code,{children:"medium"}),", ",(0,i.jsx)(t.code,{children:"high"}),", or ",(0,i.jsx)(t.code,{children:"critical"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"tags"})}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:"Array of tags for filtering"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"mitre_attack"})}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:"MITRE ATT&CK technique IDs"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"owasp_mcp"})}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:"OWASP MCP Top 10 IDs"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"detection_guidance"})}),(0,i.jsx)(t.td,{children:"No"}),(0,i.jsx)(t.td,{children:"How defenders can detect this attack"})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"3-add-mitre-attck-and-owasp-mappings",children:"3. Add MITRE ATT&CK and OWASP mappings"}),"\n",(0,i.jsx)(t.p,{children:"For security framework coverage tracking, add taxonomy references:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:'metadata:\n  id: "my-attack"\n  name: "My Custom Attack"\n  description: "Brief description"\n  category: "injection"\n  mitre_attack:\n    - "T1059.004"    # Command and Scripting Interpreter: Unix Shell\n    - "T1552.001"    # Unsecured Credentials: Credentials In Files\n  owasp_mcp:\n    - "MCP-01"       # Tool Injection\n  detection_guidance: >\n    Monitor for tool definitions containing file path references\n    or system command instructions in their descriptions.\n'})}),"\n",(0,i.jsx)(t.h2,{id:"4-validate",children:"4. Validate"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"thoughtjack server validate library/servers/my_attack.yaml\n"})}),"\n",(0,i.jsx)(t.h2,{id:"5-test-the-scenario",children:"5. Test the scenario"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"thoughtjack server run --config library/servers/my_attack.yaml -vv\n"})}),"\n",(0,i.jsx)(t.h2,{id:"6-generate-documentation",children:"6. Generate documentation"}),"\n",(0,i.jsx)(t.p,{children:"After adding the scenario, regenerate the docs:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"thoughtjack docs generate --output-dir docs-site/docs/scenarios\nthoughtjack docs validate\n"})}),"\n",(0,i.jsx)(t.p,{children:"Your scenario will appear in the Attack Catalog with its metadata card, phase diagram, and YAML source toggle."})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453(e,t,n){n.d(t,{R:()=>d,x:()=>s});var r=n(6540);const i={},a=r.createContext(i);function d(e){const t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);