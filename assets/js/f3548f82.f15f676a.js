"use strict";(globalThis.webpackChunkthoughtjack_docs_site=globalThis.webpackChunkthoughtjack_docs_site||[]).push([[7737],{1012(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"reference/scenarios-metadata","title":"Scenario Metadata Schema","description":"Metadata block fields for scenario registration and documentation","source":"@site/docs/reference/scenarios-metadata.mdx","sourceDirName":"reference","slug":"/reference/scenarios-metadata","permalink":"/docs/reference/scenarios-metadata","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Scenario Metadata Schema","sidebar_position":6,"description":"Metadata block fields for scenario registration and documentation"},"sidebar":"docs","previous":{"title":"Behavioral Modes","permalink":"/docs/reference/behaviors"},"next":{"title":"Phase Triggers","permalink":"/docs/reference/triggers"}}');var s=i(4848),r=i(8453);const c={title:"Scenario Metadata Schema",sidebar_position:6,description:"Metadata block fields for scenario registration and documentation"},d="Scenario Metadata Schema",a={},o=[{value:"Schema",id:"schema",level:2},{value:"Fields",id:"fields",level:2},{value:"<code>id</code>",id:"id",level:3},{value:"<code>name</code>",id:"name",level:3},{value:"<code>description</code>",id:"description",level:3},{value:"<code>category</code>",id:"category",level:3},{value:"<code>severity</code>",id:"severity",level:3},{value:"<code>tags</code>",id:"tags",level:3},{value:"<code>mitre_attack</code>",id:"mitre_attack",level:3},{value:"<code>owasp_mcp</code>",id:"owasp_mcp",level:3},{value:"<code>detection_guidance</code>",id:"detection_guidance",level:3},{value:"Example",id:"example",level:2},{value:"Built-in scenario categories",id:"built-in-scenario-categories",level:2},{value:"Fuzzy matching",id:"fuzzy-matching",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"scenario-metadata-schema",children:"Scenario Metadata Schema"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"metadata"})," block in a ThoughtJack configuration defines how a scenario appears in ",(0,s.jsx)(n.code,{children:"scenarios list"}),", ",(0,s.jsx)(n.code,{children:"scenarios show"}),", and the generated documentation site."]}),"\n",(0,s.jsx)(n.h2,{id:"schema",children:"Schema"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"metadata:\n  id: string                   # Required \u2014 unique identifier (kebab-case)\n  name: string                 # Required \u2014 human-readable display name\n  description: string          # Required \u2014 one-line description\n  category: string             # Required \u2014 scenario category\n  severity: string             # Optional \u2014 severity rating\n  tags: [string]               # Optional \u2014 searchable tags\n  mitre_attack: [string]       # Optional \u2014 MITRE ATT&CK technique IDs\n  owasp_mcp: [string]          # Optional \u2014 OWASP MCP Top 10 IDs\n  detection_guidance: string   # Optional \u2014 how defenders can detect this attack\n"})}),"\n",(0,s.jsx)(n.h2,{id:"fields",children:"Fields"}),"\n",(0,s.jsx)(n.h3,{id:"id",children:(0,s.jsx)(n.code,{children:"id"})}),"\n",(0,s.jsx)(n.p,{children:"Unique identifier for the scenario. Must be kebab-case (lowercase with hyphens)."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Constraint"}),(0,s.jsx)(n.th,{children:"Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Format"}),(0,s.jsx)(n.td,{children:"kebab-case"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Uniqueness"}),(0,s.jsx)(n.td,{children:"Must be unique across all scenarios"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Examples"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"rug-pull"}),", ",(0,s.jsx)(n.code,{children:"nested-json-dos"}),", ",(0,s.jsx)(n.code,{children:"credential-phishing"})]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"name",children:(0,s.jsx)(n.code,{children:"name"})}),"\n",(0,s.jsx)(n.p,{children:"Human-readable display name shown in listings and documentation."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Constraint"}),(0,s.jsx)(n.th,{children:"Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Format"}),(0,s.jsx)(n.td,{children:"Free text"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Examples"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:'"Rug Pull Attack"'}),", ",(0,s.jsx)(n.code,{children:'"Nested JSON DoS"'})]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"description",children:(0,s.jsx)(n.code,{children:"description"})}),"\n",(0,s.jsxs)(n.p,{children:["One-line description of the attack pattern. Shown in ",(0,s.jsx)(n.code,{children:"scenarios list"})," output and documentation summaries."]}),"\n",(0,s.jsx)(n.h3,{id:"category",children:(0,s.jsx)(n.code,{children:"category"})}),"\n",(0,s.jsx)(n.p,{children:"Scenario category for grouping and filtering."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Value"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"injection"})}),(0,s.jsx)(n.td,{children:"Content injection attacks (prompt injection, phishing)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"dos"})}),(0,s.jsx)(n.td,{children:"Denial of service attacks (resource exhaustion, flooding)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"temporal"})}),(0,s.jsx)(n.td,{children:"Time-based attacks (rug pulls, sleeper agents)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"resource"})}),(0,s.jsx)(n.td,{children:"Resource-based attacks (exfiltration, mutation)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"protocol"})}),(0,s.jsx)(n.td,{children:"Protocol-level attacks (ID collision, batch abuse)"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"severity",children:(0,s.jsx)(n.code,{children:"severity"})}),"\n",(0,s.jsx)(n.p,{children:"Severity rating for the attack pattern."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Value"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"low"})}),(0,s.jsx)(n.td,{children:"Minor impact, easily detected"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"medium"})}),(0,s.jsx)(n.td,{children:"Moderate impact"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"high"})}),(0,s.jsx)(n.td,{children:"Significant impact, harder to detect"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"critical"})}),(0,s.jsx)(n.td,{children:"Severe impact, difficult to detect"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"tags",children:(0,s.jsx)(n.code,{children:"tags"})}),"\n",(0,s.jsx)(n.p,{children:"Array of searchable tags for filtering and categorization."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"tags:\n  - prompt-injection\n  - tool-manipulation\n  - trust-building\n  - credential-theft\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mitre_attack",children:(0,s.jsx)(n.code,{children:"mitre_attack"})}),"\n",(0,s.jsx)(n.p,{children:"MITRE ATT&CK technique IDs that this scenario maps to."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'mitre_attack:\n  - "T1059.004"    # Command and Scripting Interpreter: Unix Shell\n  - "T1552.001"    # Unsecured Credentials: Credentials In Files\n  - "T1027"        # Obfuscated Files or Information\n'})}),"\n",(0,s.jsx)(n.p,{children:"These IDs appear on the generated scenario pages and in the MITRE ATT&CK coverage matrix."}),"\n",(0,s.jsx)(n.h3,{id:"owasp_mcp",children:(0,s.jsx)(n.code,{children:"owasp_mcp"})}),"\n",(0,s.jsx)(n.p,{children:"OWASP MCP Top 10 identifiers that this scenario maps to."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'owasp_mcp:\n  - "MCP-01"       # Tool Injection\n  - "MCP-03"       # Capability Mutation\n'})}),"\n",(0,s.jsx)(n.h3,{id:"detection_guidance",children:(0,s.jsx)(n.code,{children:"detection_guidance"})}),"\n",(0,s.jsx)(n.p,{children:"Free-text guidance for defenders on how to detect this attack pattern."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"detection_guidance: >\n  Monitor for tool definition changes after initialization.\n  Alert on notifications/tools/list_changed events that add\n  tools with file path references in descriptions.\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'metadata:\n  id: "rug-pull"\n  name: "Rug Pull Attack"\n  description: "Trust-building calculator that swaps in malicious tools"\n  category: "temporal"\n  severity: "high"\n  tags:\n    - rug-pull\n    - tool-injection\n    - trust-building\n  mitre_attack:\n    - "T1059.004"\n  owasp_mcp:\n    - "MCP-01"\n    - "MCP-03"\n  detection_guidance: >\n    Monitor for notifications/tools/list_changed events. Compare tool\n    definitions before and after to detect added or modified tools.\n    Flag tools whose descriptions contain file path references or\n    instructions that differ from initial definitions.\n'})}),"\n",(0,s.jsx)(n.h2,{id:"built-in-scenario-categories",children:"Built-in scenario categories"}),"\n",(0,s.jsx)(n.p,{children:"The 10 built-in scenarios are distributed across categories:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Category"}),(0,s.jsx)(n.th,{children:"Scenarios"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Temporal"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"rug-pull"}),", ",(0,s.jsx)(n.code,{children:"response-sequence"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Injection"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"prompt-injection"}),", ",(0,s.jsx)(n.code,{children:"credential-phishing"}),", ",(0,s.jsx)(n.code,{children:"unicode-obfuscation"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"DoS"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"slow-loris"}),", ",(0,s.jsx)(n.code,{children:"nested-json-dos"}),", ",(0,s.jsx)(n.code,{children:"notification-flood"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Resource"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"resource-exfiltration"}),", ",(0,s.jsx)(n.code,{children:"resource-rug-pull"})]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"fuzzy-matching",children:"Fuzzy matching"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"scenarios show"})," supports fuzzy name matching using Damerau-Levenshtein distance (threshold \u2264 3). If you type ",(0,s.jsx)(n.code,{children:"rug-pul"})," or ",(0,s.jsx)(n.code,{children:"rug_pull"}),", ThoughtJack will suggest the correct scenario name."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453(e,n,i){i.d(n,{R:()=>c,x:()=>d});var t=i(6540);const s={},r=t.createContext(s);function c(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);