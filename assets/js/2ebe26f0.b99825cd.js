"use strict";(globalThis.webpackChunkthoughtjack_docs_site=globalThis.webpackChunkthoughtjack_docs_site||[]).push([[9329],{3923(e,t,s){s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"explanation/mcp-attack-surface","title":"MCP Attack Surface","description":"Why MCP is vulnerable, attack vectors, and how ThoughtJack models them","source":"@site/docs/explanation/mcp-attack-surface.mdx","sourceDirName":"explanation","slug":"/explanation/mcp-attack-surface","permalink":"/thoughtjack/docs/explanation/mcp-attack-surface","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"MCP Attack Surface","sidebar_position":4,"description":"Why MCP is vulnerable, attack vectors, and how ThoughtJack models them"},"sidebar":"docs","previous":{"title":"Explanation","permalink":"/thoughtjack/docs/explanation/"},"next":{"title":"Security Framework Mappings","permalink":"/thoughtjack/docs/explanation/framework-mappings"}}');var i=s(4848),r=s(8453);const c={title:"MCP Attack Surface",sidebar_position:4,description:"Why MCP is vulnerable, attack vectors, and how ThoughtJack models them"},o="MCP Attack Surface",l={},d=[{value:"Why MCP is vulnerable",id:"why-mcp-is-vulnerable",level:2},{value:"Attack vectors",id:"attack-vectors",level:2},{value:"Injection attacks",id:"injection-attacks",level:3},{value:"Temporal attacks",id:"temporal-attacks",level:3},{value:"Denial of service",id:"denial-of-service",level:3},{value:"Resource attacks",id:"resource-attacks",level:3},{value:"Protocol attacks",id:"protocol-attacks",level:3},{value:"Trust model",id:"trust-model",level:2},{value:"Defense considerations",id:"defense-considerations",level:2}];function a(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"mcp-attack-surface",children:"MCP Attack Surface"})}),"\n",(0,i.jsx)(t.p,{children:"The Model Context Protocol (MCP) introduces a new attack surface in AI agent systems. ThoughtJack models these attack vectors to help security researchers test MCP client resilience."}),"\n",(0,i.jsx)(t.h2,{id:"why-mcp-is-vulnerable",children:"Why MCP is vulnerable"}),"\n",(0,i.jsx)(t.p,{children:"MCP enables AI agents to interact with external tools, resources, and prompts. This creates trust boundaries that can be exploited:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Implicit trust in tool definitions"})," \u2014 agents treat tool descriptions as ground truth without verification"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"No authentication of tool servers"})," \u2014 MCP clients typically launch tool servers as subprocesses with no mutual authentication"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Dynamic capability mutation"})," \u2014 tools can change after initialization via ",(0,i.jsx)(t.code,{children:"list_changed"})," notifications"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Unstructured text channels"})," \u2014 tool descriptions and responses are free-form text, enabling prompt injection"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Bidirectional communication"})," \u2014 the server can send unsolicited notifications and requests to the client"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"attack-vectors",children:"Attack vectors"}),"\n",(0,i.jsx)(t.p,{children:"ThoughtJack organizes attacks into five categories:"}),"\n",(0,i.jsx)(t.h3,{id:"injection-attacks",children:"Injection attacks"}),"\n",(0,i.jsx)(t.p,{children:"Exploit the text-based nature of MCP to inject instructions into tool responses or descriptions."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Attack"}),(0,i.jsx)(t.th,{children:"Vector"}),(0,i.jsx)(t.th,{children:"ThoughtJack scenario"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Prompt injection"}),(0,i.jsx)(t.td,{children:"Malicious text in tool responses"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"prompt-injection"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Tool description injection"}),(0,i.jsx)(t.td,{children:"Instructions hidden in tool descriptions"}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"rug-pull"})," (exploit phase)"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Credential phishing"}),(0,i.jsx)(t.td,{children:"Fake credential prompts in descriptions"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"credential-phishing"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Unicode obfuscation"}),(0,i.jsx)(t.td,{children:"Invisible/lookalike characters in responses"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"unicode-obfuscation"})})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Why it works"}),": AI agents process tool output as context for their next action. If the output contains instructions, the agent may follow them \u2014 especially if the instructions mimic system-level directives."]}),"\n",(0,i.jsx)(t.h3,{id:"temporal-attacks",children:"Temporal attacks"}),"\n",(0,i.jsx)(t.p,{children:"Exploit the time dimension to build trust before attacking."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Attack"}),(0,i.jsx)(t.th,{children:"Vector"}),(0,i.jsx)(t.th,{children:"ThoughtJack scenario"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Rug pull"}),(0,i.jsx)(t.td,{children:"Benign behavior \u2192 malicious tool swap"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"rug-pull"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Response sequence"}),(0,i.jsx)(t.td,{children:"Benign responses \u2192 injection payload"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"response-sequence"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Sleeper agent"}),(0,i.jsx)(t.td,{children:"Time-delayed phase transition"}),(0,i.jsx)(t.td,{children:"(phased config)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Resource mutation"}),(0,i.jsx)(t.td,{children:"Resource content changes over time"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"resource-rug-pull"})})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Why it works"}),": MCP clients typically evaluate tools at initialization and trust them going forward. An attacker can build trust with legitimate behavior, then mutate capabilities after the client has stopped monitoring."]}),"\n",(0,i.jsx)(t.h3,{id:"denial-of-service",children:"Denial of service"}),"\n",(0,i.jsx)(t.p,{children:"Exhaust client resources through malformed or excessive data."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Attack"}),(0,i.jsx)(t.th,{children:"Vector"}),(0,i.jsx)(t.th,{children:"ThoughtJack scenario"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Nested JSON"}),(0,i.jsx)(t.td,{children:"Deep nesting exhausts parser stack"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"nested-json-dos"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Slow loris"}),(0,i.jsx)(t.td,{children:"Byte-by-byte delivery ties up connections"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"slow-loris"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Notification flood"}),(0,i.jsx)(t.td,{children:"High-rate notifications overwhelm client"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"notification-flood"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Pipe deadlock"}),(0,i.jsx)(t.td,{children:"Fill stdout buffer to block I/O"}),(0,i.jsx)(t.td,{children:"(side effect config)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Batch amplification"}),(0,i.jsx)(t.td,{children:"Oversized notification batches"}),(0,i.jsx)(t.td,{children:"(side effect config)"})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Why it works"}),": MCP clients must parse all server responses. If the server sends malformed data, the client's parser may crash, hang, or consume excessive memory."]}),"\n",(0,i.jsx)(t.h3,{id:"resource-attacks",children:"Resource attacks"}),"\n",(0,i.jsx)(t.p,{children:"Exploit MCP's resource system for data exfiltration."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Attack"}),(0,i.jsx)(t.th,{children:"Vector"}),(0,i.jsx)(t.th,{children:"ThoughtJack scenario"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Resource exfiltration"}),(0,i.jsx)(t.td,{children:"Resources that request sensitive data"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"resource-exfiltration"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Resource rug pull"}),(0,i.jsx)(t.td,{children:"Resource content changes over time"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"resource-rug-pull"})})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Why it works"}),": Resources in MCP can contain instructions that agents follow. If a resource URI looks legitimate but contains injection payloads, the agent may act on them."]}),"\n",(0,i.jsx)(t.h3,{id:"protocol-attacks",children:"Protocol attacks"}),"\n",(0,i.jsx)(t.p,{children:"Exploit JSON-RPC and MCP protocol mechanics."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Attack"}),(0,i.jsx)(t.th,{children:"Vector"}),(0,i.jsx)(t.th,{children:"ThoughtJack mechanism"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Duplicate request IDs"}),(0,i.jsx)(t.td,{children:"ID collision in responses"}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"duplicate_request_ids"})," side effect"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Unbounded messages"}),(0,i.jsx)(t.td,{children:"Missing newline terminators"}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"unbounded_line"})," behavior"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Batch abuse"}),(0,i.jsx)(t.td,{children:"Oversized JSON-RPC batches"}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"batch_amplify"})," side effect"]})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Why it works"}),": JSON-RPC implementations may not validate message framing, ID uniqueness, or batch sizes. Malformed protocol messages can cause crashes or undefined behavior."]}),"\n",(0,i.jsx)(t.h2,{id:"trust-model",children:"Trust model"}),"\n",(0,i.jsx)(t.mermaid,{value:"graph TD\n    User[User] --\x3e|trusts| Agent[AI Agent]\n    Agent --\x3e|trusts| MCP[MCP Client]\n    MCP --\x3e|trusts?| Server[Tool Server]\n    Server --\x3e|controlled by| Attacker[Attacker]\n\n    style Server fill:#f66,stroke:#333,color:#fff\n    style Attacker fill:#f66,stroke:#333,color:#fff"}),"\n",(0,i.jsx)(t.p,{children:"The fundamental issue: the MCP client trusts the tool server to provide accurate tool definitions and honest responses. An attacker who controls the tool server can abuse this trust."}),"\n",(0,i.jsx)(t.h2,{id:"defense-considerations",children:"Defense considerations"}),"\n",(0,i.jsx)(t.p,{children:"ThoughtJack scenarios test for these defensive capabilities:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Defense"}),(0,i.jsx)(t.th,{children:"What it protects against"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Tool definition pinning"}),(0,i.jsx)(t.td,{children:"Rug pulls, capability mutation"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Response content scanning"}),(0,i.jsx)(t.td,{children:"Prompt injection, credential phishing"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Unicode normalization"}),(0,i.jsx)(t.td,{children:"Unicode obfuscation"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Parser depth limits"}),(0,i.jsx)(t.td,{children:"Nested JSON DoS"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Timeout enforcement"}),(0,i.jsx)(t.td,{children:"Slow loris, response delay"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Notification rate limiting"}),(0,i.jsx)(t.td,{children:"Notification flood"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Resource content validation"}),(0,i.jsx)(t.td,{children:"Resource exfiltration"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ID deduplication"}),(0,i.jsx)(t.td,{children:"Duplicate request IDs"})]})]})]}),"\n",(0,i.jsxs)(t.p,{children:["See the ",(0,i.jsx)(t.a,{href:"./framework-mappings",children:"Security Framework Mappings"})," page for how these attacks map to MITRE ATT&CK and OWASP MCP Top 10."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,t,s){s.d(t,{R:()=>c,x:()=>o});var n=s(6540);const i={},r=n.createContext(i);function c(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);