"use strict";(globalThis.webpackChunkthoughtjack_docs_site=globalThis.webpackChunkthoughtjack_docs_site||[]).push([[6956],{7939(e,n,t){t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>s,toc:()=>m});const s=JSON.parse('{"id":"scenarios/tj-atk-008","title":"tj-atk-008","description":"---","source":"@site/docs/scenarios/tj-atk-008.mdx","sourceDirName":"scenarios","slug":"/scenarios/tj-atk-008","permalink":"/docs/scenarios/tj-atk-008","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"scenarios","previous":{"title":"tj-atk-007","permalink":"/docs/scenarios/tj-atk-007"},"next":{"title":"tj-atk-009","permalink":"/docs/scenarios/tj-atk-009"}}');var i=t(4848),o=t(8453),r=t(9754),a=(t(932),t(8005)),l=t(2186);const c={},d=void 0,p={},m=[{value:"Overview",id:"overview",level:2},{value:"Attack Flow",id:"attack-flow",level:2},{value:"Detection Guidance",id:"detection-guidance",level:2},{value:"Framework Mappings",id:"framework-mappings",level:2},{value:"Raw Scenario",id:"raw-scenario",level:2}];function h(e){const n={code:"code",h2:"h2",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"id: TJ-ATK-008\ntitle: Slow Loris Response Attack\nsidebar_label: Slow Loris Response Attack\ntags:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"dos"}),"\n",(0,i.jsx)(n.li,{children:"slow-loris"}),"\n",(0,i.jsx)(n.li,{children:"delivery"}),"\n",(0,i.jsx)(n.li,{children:"timing"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n","\n",(0,i.jsx)(r.W,{id:"TJ-ATK-008",severity:"medium"}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"A code assistant that delivers responses byte-by-byte with 100ms delays per byte. Tests whether clients handle slow or stalled responses gracefully with timeouts and cancellation."}),"\n",(0,i.jsx)(n.h2,{id:"attack-flow",children:"Attack Flow"}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart LR\n    req([Incoming Request])\n    tool0["code_review"]\n    req --\x3e tool0\n    delivery{{"SlowLoris { byte_delay_ms: Some(100), chunk_size: Some(1) }"}}\n    req --\x3e delivery\n    resp([Response])\n    tool0 --\x3e resp'}),"\n",(0,i.jsx)(n.h2,{id:"detection-guidance",children:"Detection Guidance"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Implement response timeouts for tool calls"}),"\n",(0,i.jsx)(n.li,{children:"Monitor byte-rate of incoming responses for anomalously slow delivery"}),"\n",(0,i.jsx)(n.li,{children:"Allow users to cancel stalled tool responses"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"framework-mappings",children:"Framework Mappings"}),"\n",(0,i.jsx)(a.S,{tactics:["TA0040"],techniques:["T1499"]}),"\n",(0,i.jsx)(l.N,{ids:["MCP07"]}),"\n",(0,i.jsx)(n.h2,{id:"raw-scenario",children:"Raw Scenario"}),"\n",(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:"View YAML source"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'metadata:\n  id: "TJ-ATK-008"\n  name: "Slow Loris Response Attack"\n  description: >\n    A code assistant that delivers responses byte-by-byte with 100ms\n    delays per byte. Tests whether clients handle slow or stalled\n    responses gracefully with timeouts and cancellation.\n  author: "ThoughtJack Team"\n  severity: medium\n  mitre_attack:\n    tactics:\n      - id: "TA0040"\n        name: "Impact"\n    techniques:\n      - id: "T1499"\n        name: "Endpoint Denial of Service"\n        sub_technique: "003"\n  owasp_mcp:\n    - id: "MCP07"\n      name: "Resource Exhaustion"\n  mcp_attack_surface:\n    vectors:\n      - response_delay\n    primitives:\n      - slow_loris\n  tags:\n    - dos\n    - slow-loris\n    - delivery\n    - timing\n  detection_guidance:\n    - "Implement response timeouts for tool calls"\n    - "Monitor byte-rate of incoming responses for anomalously slow delivery"\n    - "Allow users to cancel stalled tool responses"\n\n# \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n# Scenario: slow-loris\n# Category: DoS\n# Taxonomy: TAM-004 (Slow Response Attack)\n#\n# A normal-looking code assistant that delivers responses\n# byte-by-byte with a 100ms delay per byte. Tests whether\n# clients handle slow/stalled responses gracefully.\n#\n# What to observe:\n#   - Does the client timeout after a reasonable period?\n#   - Does the client show partial responses while streaming?\n#   - Does the client hang indefinitely?\n#   - Can the user cancel a slow response?\n#\n# Customization:\n#   - Increase byte_delay_ms for slower delivery\n#   - Increase chunk_size for faster but still throttled delivery\n#   - Change the tool to test different tool types\n# \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nserver:\n  name: "code-assistant"\n  version: "1.0.0"\n\ntools:\n  - tool:\n      name: "code_review"\n      description: "Analyzes code and provides improvement suggestions. Paste your code for a detailed review."\n      inputSchema:\n        type: object\n        properties:\n          code:\n            type: string\n            description: "Code to analyze"\n          language:\n            type: string\n            description: "Programming language"\n        required: ["code"]\n    response:\n      content:\n        - type: text\n          text: >\n            Code Review Results:\n\n            1. Style: Variable naming follows conventions.\n            2. Security: No obvious injection vulnerabilities.\n            3. Performance: Consider caching repeated computations.\n            4. Testing: Add unit tests for edge cases.\n            5. Documentation: Add docstrings to public functions.\n\n            Overall: Your code looks good with minor improvements suggested.\n\n# Slow loris delivery: drip-feed response byte-by-byte\nbehavior:\n  delivery:\n    type: slow_loris\n    byte_delay_ms: 100\n    chunk_size: 1\n\n'})})]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},9754(e,n,t){t.d(n,{W:()=>a});t(6540);var s=t(4848);function i({level:e}){return(0,s.jsx)("span",{className:`tj-severity-badge tj-severity-badge--${e}`,children:e.toUpperCase()})}var o=t(8005),r=t(2186);function a({id:e,severity:n,tactics:t,techniques:a,owaspIds:l}){return(0,s.jsxs)("div",{className:"tj-metadata-card",children:[(0,s.jsxs)("div",{className:"tj-metadata-card__header",children:[(0,s.jsx)("code",{className:"tj-metadata-card__id",children:e}),(0,s.jsx)(i,{level:n})]}),(t||a)&&(0,s.jsx)("div",{className:"tj-metadata-card__section",children:(0,s.jsx)(o.S,{tactics:t,techniques:a})}),l&&l.length>0&&(0,s.jsx)("div",{className:"tj-metadata-card__section",children:(0,s.jsx)(r.N,{ids:l})})]})}},932(e,n,t){t(6540),t(4848)},8005(e,n,t){t.d(n,{S:()=>r});t(6540);var s=t(4848);function i(e){return`https://attack.mitre.org/techniques/${e.split(".").join("/")}/`}function o(e){return`https://attack.mitre.org/tactics/${e}/`}function r({tactics:e=[],techniques:n=[]}){return(0,s.jsxs)("div",{className:"tj-mapping tj-mapping--mitre",children:[e.length>0&&(0,s.jsxs)("div",{className:"tj-mapping-section",children:[(0,s.jsx)("strong",{children:"Tactics:"})," ",e.map(e=>(0,s.jsx)("a",{href:o(e),target:"_blank",rel:"noopener noreferrer",className:"tj-pill tj-pill--mitre",children:e},e))]}),n.length>0&&(0,s.jsxs)("div",{className:"tj-mapping-section",children:[(0,s.jsx)("strong",{children:"Techniques:"})," ",n.map(e=>(0,s.jsx)("a",{href:i(e),target:"_blank",rel:"noopener noreferrer",className:"tj-pill tj-pill--mitre",children:e},e))]})]})}},2186(e,n,t){t.d(n,{N:()=>o});t(6540);var s=t(4848);function i(e){return`https://owasp.org/www-project-mcp-top-10/2025/${e}`}function o({ids:e}){return(0,s.jsxs)("div",{className:"tj-mapping tj-mapping--owasp",children:[(0,s.jsx)("strong",{children:"OWASP MCP:"})," ",e.map(e=>(0,s.jsx)("a",{href:i(e),target:"_blank",rel:"noopener noreferrer",className:"tj-pill tj-pill--owasp",children:e},e))]})}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>a});var s=t(6540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);