"use strict";(globalThis.webpackChunkthoughtjack_docs_site=globalThis.webpackChunkthoughtjack_docs_site||[]).push([[848],{3166(e,n,t){t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"how-to/configure-side-effects","title":"Configure Side Effects","description":"Set up notification floods, pipe deadlocks, and other side effects","source":"@site/docs/how-to/configure-side-effects.mdx","sourceDirName":"how-to","slug":"/how-to/configure-side-effects","permalink":"/docs/how-to/configure-side-effects","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Configure Side Effects","sidebar_position":4,"description":"Set up notification floods, pipe deadlocks, and other side effects"},"sidebar":"docs","previous":{"title":"Configure Delivery Behaviors","permalink":"/docs/how-to/configure-behaviors"},"next":{"title":"Use Payload Generators","permalink":"/docs/how-to/use-generators"}}');var i=t(4848),c=t(8453);const o={title:"Configure Side Effects",sidebar_position:4,description:"Set up notification floods, pipe deadlocks, and other side effects"},d="Configure Side Effects",r={},l=[{value:"Available side effects",id:"available-side-effects",level:2},{value:"Add side effects to config",id:"add-side-effects-to-config",level:2},{value:"Notification flood",id:"notification-flood",level:2},{value:"Batch amplify",id:"batch-amplify",level:2},{value:"Pipe deadlock",id:"pipe-deadlock",level:2},{value:"Close connection",id:"close-connection",level:2},{value:"Duplicate request IDs",id:"duplicate-request-ids",level:2},{value:"Side effect triggers",id:"side-effect-triggers",level:2},{value:"Multiple side effects",id:"multiple-side-effects",level:2},{value:"Phase-specific side effects",id:"phase-specific-side-effects",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"configure-side-effects",children:"Configure Side Effects"})}),"\n",(0,i.jsx)(n.p,{children:"Side effects are additional actions that ThoughtJack executes alongside (or instead of) normal responses. They test how MCP clients handle unexpected server behavior."}),"\n",(0,i.jsx)(n.h2,{id:"available-side-effects",children:"Available side effects"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Side Effect"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Transport"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"notification_flood"})}),(0,i.jsx)(n.td,{children:"Spam MCP notifications at configurable rate"}),(0,i.jsx)(n.td,{children:"stdio, HTTP"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"batch_amplify"})}),(0,i.jsx)(n.td,{children:"Send oversized JSON-RPC notification batches"}),(0,i.jsx)(n.td,{children:"stdio, HTTP"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"pipe_deadlock"})}),(0,i.jsx)(n.td,{children:"Fill stdout buffer to block bidirectional I/O"}),(0,i.jsx)(n.td,{children:"stdio only"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"close_connection"})}),(0,i.jsx)(n.td,{children:"Force-close the transport connection"}),(0,i.jsx)(n.td,{children:"stdio, HTTP"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"duplicate_request_ids"})}),(0,i.jsx)(n.td,{children:"Send responses with colliding request IDs"}),(0,i.jsx)(n.td,{children:"stdio, HTTP"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"add-side-effects-to-config",children:"Add side effects to config"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: notification_flood\n      rate_per_second: 100\n      duration_ms: 5000\n"})}),"\n",(0,i.jsx)(n.h2,{id:"notification-flood",children:"Notification flood"}),"\n",(0,i.jsx)(n.p,{children:"Sends MCP notifications at a high rate to test client queuing and backpressure handling."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: notification_flood\n      rate_per_second: 100     # notifications per second\n      duration_ms: 5000        # how long to flood\n      trigger: on_request      # when to start (default)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What to test"}),": Does the client queue notifications? Does it drop them? Does the UI remain responsive?"]}),"\n",(0,i.jsx)(n.h2,{id:"batch-amplify",children:"Batch amplify"}),"\n",(0,i.jsx)(n.p,{children:"Sends an oversized batch of JSON-RPC notifications in a single message."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: batch_amplify\n      count: 1000              # notifications per batch\n      trigger: on_request\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What to test"}),": Does the client parse the batch? Does it apply size limits?"]}),"\n",(0,i.jsx)(n.h2,{id:"pipe-deadlock",children:"Pipe deadlock"}),"\n",(0,i.jsx)(n.p,{children:"Fills the stdout buffer without reading stdin, causing a bidirectional I/O deadlock. Only works with stdio transport."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: pipe_deadlock\n      trigger: on_request\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What to test"}),": Does the client detect the deadlock? Does it timeout and recover?"]}),"\n",(0,i.jsx)(n.h2,{id:"close-connection",children:"Close connection"}),"\n",(0,i.jsx)(n.p,{children:"Forces the transport connection closed. Tests client reconnection logic."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: close_connection\n      graceful: false          # true for clean close, false for abrupt\n      trigger: on_request\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What to test"}),": Does the client reconnect? Does it lose state?"]}),"\n",(0,i.jsx)(n.h2,{id:"duplicate-request-ids",children:"Duplicate request IDs"}),"\n",(0,i.jsx)(n.p,{children:"Sends multiple responses with the same request ID, testing ID collision handling."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: duplicate_request_ids\n      trigger: on_request\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What to test"}),": Does the client match responses correctly? Does it detect duplicates?"]}),"\n",(0,i.jsx)(n.h2,{id:"side-effect-triggers",children:"Side effect triggers"}),"\n",(0,i.jsx)(n.p,{children:"Control when side effects fire:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Trigger"}),(0,i.jsx)(n.th,{children:"When it fires"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"on_connect"})}),(0,i.jsx)(n.td,{children:"When a client connects"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"on_request"})}),(0,i.jsx)(n.td,{children:"On each incoming request (default)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"on_subscribe"})}),(0,i.jsx)(n.td,{children:"When the client subscribes to a resource"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"on_unsubscribe"})}),(0,i.jsx)(n.td,{children:"When the client unsubscribes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"continuous"})}),(0,i.jsx)(n.td,{children:"Continuously in a background loop"})]})]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: notification_flood\n      rate_per_second: 50\n      duration_ms: 10000\n      trigger: on_connect       # start flooding on connect\n"})}),"\n",(0,i.jsx)(n.h2,{id:"multiple-side-effects",children:"Multiple side effects"}),"\n",(0,i.jsx)(n.p,{children:"You can configure multiple side effects that run concurrently:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"behavior:\n  side_effects:\n    - type: notification_flood\n      rate_per_second: 50\n      duration_ms: 5000\n      trigger: on_request\n    - type: duplicate_request_ids\n      trigger: on_request\n"})}),"\n",(0,i.jsx)(n.h2,{id:"phase-specific-side-effects",children:"Phase-specific side effects"}),"\n",(0,i.jsx)(n.p,{children:"Side effects can be scoped to specific phases:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'phases:\n  - name: benign\n    advance:\n      on: tools/call\n      count: 3\n\n  - name: attack\n    on_enter:\n      - log: "Activating side effects"\n    behavior:\n      side_effects:\n        - type: notification_flood\n          rate_per_second: 100\n          duration_ms: 10000\n'})}),"\n",(0,i.jsx)(n.p,{children:"This keeps the server benign during the trust-building phase and only activates side effects after the phase transition."})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>d});var s=t(6540);const i={},c=s.createContext(i);function o(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);